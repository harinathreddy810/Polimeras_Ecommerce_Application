<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="utf-8" />-->
<!--    <meta name="viewport" content="width=device-width,initial-scale=1">-->
<!--    <title>Product</title>-->
<!--    <link rel="shortcut icon" href="http://localhost:8080/uploads/leaf-logo-final.png" type="image/x-icon">-->
<!--    &lt;!&ndash; Bootstrap 5 + Material-Design Icons &ndash;&gt;-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css" rel="stylesheet">-->
<!--    <style>-->
<!--        :root {-->
<!--            &#45;&#45;poly-yellow: #ffb600;-->
<!--            &#45;&#45;poly-dark: #000;-->
<!--            &#45;&#45;poly-gray: #f8f9fa;-->
<!--        }-->

<!--        .navbar {-->
<!--            background: var(&#45;&#45;poly-dark);-->
<!--            position: sticky;-->
<!--            top: 0;-->
<!--            z-index: 30;-->
<!--        }-->

<!--        .navbar .nav-link {-->
<!--            color: #fff !important;-->
<!--            font-weight: 500;-->
<!--        }-->

<!--        .navbar .nav-link:hover {-->
<!--            color: var(&#45;&#45;poly-yellow) !important;-->
<!--        }-->

<!--        body {-->
<!--            font-family: Poppins, sans-serif;-->
<!--            background: #f8f9fa;-->
<!--        }-->
<!--        .btn{-->
<!--            background-color: #2A6FDD ;-->
<!--            color: white;-->
<!--        }-->

<!--        .mb-3:hover{-->
<!--            background-color: #2A6FDD ;-->
<!--            color: white;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .big-img {-->
<!--            width: 100%;-->
<!--            max-width: 420px;-->
<!--            height: 420px;-->
<!--            object-fit: cover;-->
<!--            border-radius: .5rem;-->
<!--        }-->

<!--        .btn-yellow {-->
<!--            background: var(&#45;&#45;poly-yellow);-->
<!--            filter: brightness(1.07);-->
<!--            color: #000;-->
<!--            border: 0;-->
<!--        }-->

<!--        .btn-yellow:hover {-->
<!--            background: var(&#45;&#45;poly-yellow);-->
<!--            color: #000;-->
<!--            border: 0;-->
<!--            cursor: pointer;-->
<!--            /*transform: translateX(120px);*/-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--&lt;!&ndash; Navigation Bar &ndash;&gt;-->
<!--<nav class="navbar navbar-expand-lg navbar-dark py-2">-->
<!--    <div class="container">-->
<!--        <a class="navbar-brand" href="/">-->
<!--&lt;!&ndash;            <img src="https://polimeraas.in/img/logo.png" width="170" height="55" alt="Polimeraas">&ndash;&gt;-->
<!--            <img src="http://localhost:8080/uploads/Polimeras-logo-white.png" width="140" height="50" alt="Polimeraas">-->

<!--        </a>-->

<!--        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">-->
<!--            <span class="navbar-toggler-icon"></span>-->
<!--        </button>-->

<!--        <div id="mainNav" class="collapse navbar-collapse">-->
<!--            <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-3">-->
<!--                <li class="nav-item"><a class="nav-link" href="/profile.html"><i class="mdi mdi-account"></i>&nbsp;Profile</a></li>-->
<!--                <li class="nav-item position-relative">-->
<!--                    <a class="nav-link" href="/user-dashboard.html"><i class="mdi mdi-cart-outline fs-4"></i></a>-->
<!--                    <span id="cartBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none">0</span>-->
<!--                </li>-->
<!--            </ul>-->
<!--        </div>-->
<!--    </div>-->
<!--</nav>-->

<!--&lt;!&ndash; Product Content &ndash;&gt;-->
<!--<div class="container py-4">-->
<!--    <button class="btn mb-3" onclick="history.back()">⬅Back</button>-->

<!--    <div class="row gy-4">-->
<!--        <div class="col-lg-5 text-center">-->
<!--            <img id="bigImage" class="big-img" alt="">-->
<!--        </div>-->
<!--        <div class="col-lg-7">-->
<!--            <h4 id="pName" class="fw-bold"></h4>-->
<!--            <div class="mb-2"><span id="rating" class="badge text-bg-success"></span></div>-->

<!--            <h3 id="pPrice" class="fw-semibold"></h3>-->
<!--            <p id="pQty" class="text-muted"></p>-->
<!--            <h6 class="fw-semibold">Description</h6>-->
<!--            <p id="pDesc" class="small"></p>-->
<!--            <button id="addBtn" class="btn btn-yellow btn-lg px-5">Add To Cart</button>-->

<!--            <hr>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>-->

<!--&lt;!&ndash; cart helpers &ndash;&gt;-->
<!--<script type="module" src="/js/cart.js"></script>-->

<!--<script type="module">-->
<!--    import { addToCart } from '/js/cart.js';-->

<!--    const id = new URLSearchParams(location.search).get('id');-->
<!--    if (!id) location.replace('index.html');-->

<!--    fetch('/api/products/' + id)-->
<!--        .then(r => r.json())-->
<!--        .then(p => {-->
<!--            document.title = p.name;-->
<!--            document.getElementById('bigImage').src    = `/api/products/${p.id}/image`;-->
<!--            document.getElementById('pName').textContent  = p.name;-->
<!--            document.getElementById('pPrice').textContent = '₹' + p.price;-->
<!--            document.getElementById('pQty').textContent   = p.quantityType || '';-->
<!--            // document.getElementById('rating').textContent = p.rating?.toFixed(1) || '';-->
<!--            document.getElementById('pDesc').textContent  = p.description || '–';-->

<!--            const addBtn = document.getElementById('addBtn');-->
<!--            if (p.stockQuantity === 0) {-->
<!--                addBtn.textContent = 'Out of Stock';-->
<!--                addBtn.disabled = true;-->
<!--                // You can also change the style if needed-->
<!--                addBtn.classList.remove('btn-yellow');-->
<!--                addBtn.classList.add('btn-secondary');-->
<!--            } else {-->
<!--                addBtn.textContent = 'Add To Cart';-->
<!--                addBtn.disabled = false;-->
<!--                // Ensure original style is applied when in stock-->
<!--                addBtn.classList.remove('btn-secondary');-->
<!--                addBtn.classList.add('btn-yellow');-->
<!--            }-->
<!--        })-->
<!--        .catch(()=>location.replace('index.html'));-->

<!--    /* single add-to-cart */-->
<!--    document.getElementById('addBtn')-->
<!--        .addEventListener('click', () => addToCart(id, 1));-->
<!--</script>-->
<!--</body>-->
<!--</html>-->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Product</title>
    <link rel="shortcut icon" href="http://localhost:8080/uploads/leaf-logo-final.png" type="image/x-icon">
    <!-- Bootstrap 5 + Material-Design Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css" rel="stylesheet">
    <style>
        :root {
            --poly-yellow: #ffb600;
            --poly-dark: #000;
            --poly-gray: #f8f9fa;
        }

        body {
            font-family: Poppins, sans-serif;
            background: #f8f9fa;
        }

        .navbar {
            background: var(--poly-dark);
            position: sticky;
            top: 0;
            z-index: 30;
        }

        .navbar .nav-link {
            color: #fff !important;
            font-weight: 500;
        }

        .navbar .nav-link:hover {
            color: var(--poly-yellow) !important;
        }

        .back-btn {
            background-color: #2A6FDD;
            color: white;
            transition: all 0.2s;
        }

        .back-btn:hover {
            background-color: #1a5bc4;
            color: white;
            cursor: pointer;
        }

        .product-img {
            width: 100%;
            max-width: 500px;
            height: 400px;
            object-fit: cover;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .btn-yellow {
            background: var(--poly-yellow);
            color: #000;
            border: 0;
            font-weight: 600;
            padding: 10px 25px;
            transition: all 0.2s;
        }

        .btn-yellow:hover {
            background: var(--poly-yellow);
            filter: brightness(0.95);
            transform: translateY(-2px);
        }

        .btn-out-of-stock {
            background: #6c757d !important;
            cursor: not-allowed !important;
        }

        .price-tag {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2A6FDD;
        }

        .quantity-type {
            color: #28a745;
            font-weight: 500;
        }

        /* Toast Notification */
        .add-to-cart-toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #28a745;
            color: white;
            padding: 12px 30px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .toast-visible {
            opacity: 1;
        }

        /* Responsive adjustments */
        @media (max-width: 992px) {
            .product-img {
                height: 350px;
            }
        }

        @media (max-width: 768px) {
            .product-img {
                height: 300px;
                margin-bottom: 20px;
            }

            .price-tag {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark py-2">
    <div class="container">
        <a class="navbar-brand" href="/">
            <img src="http://localhost:8080/uploads/Polimeras-logo-white.png" width="140" height="50" alt="Polimeraas">
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div id="mainNav" class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-3">
                <li class="nav-item"><a class="nav-link" href="/profile.html"><i class="mdi mdi-account"></i>&nbsp;Profile</a></li>
                <li class="nav-item position-relative">
                    <a class="nav-link" href="/user-dashboard.html"><i class="mdi mdi-cart-outline fs-4"></i></a>
                    <span id="cartBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none">0</span>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Toast Notification -->
<div id="addToCartToast" class="add-to-cart-toast">
    <i class="mdi mdi-check-circle" style="font-size: 1.2rem;"></i>
    <span>Product added to cart!</span>
</div>

<!-- Product Content -->
<div class="container py-4">
    <button class="btn back-btn mb-4" onclick="history.back()">
        <i class="mdi mdi-arrow-left"></i> Back
    </button>

    <div class="row">
        <!-- Product Image -->
        <div class="col-lg-6 text-center">
            <img id="bigImage" class="product-img shadow" alt="">
        </div>

        <!-- Product Details -->
        <div class="col-lg-6">
            <h2 id="pName" class="fw-bold mb-3"></h2>

            <div class="d-flex align-items-center mb-3">
                <span id="rating" class="badge text-bg-success me-2"></span>
                <span id="pQty" class="quantity-type"></span>
            </div>

            <div class="price-tag mb-4" id="pPrice"></div>

            <div class="mb-4">
                <h5 class="fw-semibold mb-2">Description</h5>
                <p id="pDesc" class="mb-0"></p>
                <p id="noDesc" class="text-muted fst-italic" style="display: none;">No description available</p>
            </div>

            <button id="addBtn" class="btn btn-yellow btn-lg mt-3">
                <i class="mdi mdi-cart-plus me-2"></i>Add To Cart
            </button>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script type="module" src="/js/cart.js"></script>

<script type="module">
    import { addToCart } from '/js/cart.js';

    const id = new URLSearchParams(location.search).get('id');
    if (!id) location.replace('index.html');

    // Get DOM elements
    const bigImage = document.getElementById('bigImage');
    const pName = document.getElementById('pName');
    const pPrice = document.getElementById('pPrice');
    const pQty = document.getElementById('pQty');
    const pDesc = document.getElementById('pDesc');
    const noDesc = document.getElementById('noDesc');
    const addBtn = document.getElementById('addBtn');
    const rating = document.getElementById('rating');
    const toast = document.getElementById('addToCartToast');
    const cartBadge = document.getElementById('cartBadge');

    fetch('/api/products/' + id)
        .then(r => r.json())
        .then(p => {
            // Set product details
            document.title = p.name + " | Polimeraas";
            bigImage.src = `/api/products/${p.id}/image`;
            pName.textContent = p.name;
            pPrice.textContent = '₹' + p.price;
            pQty.textContent = p.quantityType || '';

            // Rating (if available)
            if (p.rating) {
                rating.textContent = p.rating.toFixed(1) + ' ★';
            } else {
                rating.style.display = 'none';
            }

            // Description
            if (p.description) {
                pDesc.textContent = p.description;
                noDesc.style.display = 'none';
            } else {
                pDesc.style.display = 'none';
                noDesc.style.display = 'block';
            }

            // Stock status
            if (p.stockQuantity === 0) {
                addBtn.textContent = 'Out of Stock';
                addBtn.disabled = true;
                addBtn.classList.remove('btn-yellow');
                addBtn.classList.add('btn-secondary', 'btn-out-of-stock');
            }
        })
        .catch(() => location.replace('index.html'));

    // Add to cart functionality
    addBtn.addEventListener('click', async () => {
        try {
            await addToCart(id, 1);

            // Show toast notification
            toast.classList.add('toast-visible');

            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('toast-visible');
            }, 3000);

            // Update cart badge
            if (cartBadge) {
                const currentCount = parseInt(cartBadge.textContent) || 0;
                // cartBadge.textContent = currentCount + 1;
                cartBadge.classList.remove('d-none');
            }
        } catch (error) {
            console.error('Error adding to cart:', error);
            alert('Failed to add item to cart. Please try again.');
        }
    });
</script>
</body>
</html>